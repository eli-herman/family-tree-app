---
phase: 01-data-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/user.ts
  - src/utils/mockData.ts
  - src/utils/relationships.ts
autonomous: true

must_haves:
  truths:
    - "FamilyMember type includes gender field for relationship labels"
    - "9 Herman family members exist with correct relationships"
    - "Relationship calculation returns correct labels from Eli's perspective"
  artifacts:
    - path: "src/types/user.ts"
      provides: "FamilyMember type with gender field"
      contains: "gender?: 'male' | 'female'"
    - path: "src/utils/mockData.ts"
      provides: "Herman family mock data"
      contains: "Peggy"
    - path: "src/utils/relationships.ts"
      provides: "Relationship calculation utility"
      exports: ["calculateRelationship"]
  key_links:
    - from: "src/utils/relationships.ts"
      to: "src/types/user.ts"
      via: "imports FamilyMember type"
      pattern: "import.*FamilyMember.*from.*types"
---

<objective>
Create Herman family mock data and relationship calculation utilities.

Purpose: Establish the data foundation that all stores will use. The Herman family data and relationship calculator are prerequisites for familyStore.
Output: Updated types, Herman family mock data (9 members), and relationship calculation utility.
</objective>

<execution_context>
@./.claude/agents/workflows/execute-plan.md
@./.claude/agents/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-data-foundation/01-CONTEXT.md
@.planning/phases/01-data-foundation/01-RESEARCH.md
@src/types/user.ts
@src/utils/mockData.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update FamilyMember type with gender field</name>
  <files>src/types/user.ts</files>
  <action>
Add `gender?: 'male' | 'female'` field to the FamilyMember interface.

This field is needed for relationship labels like "Brother-in-law" vs "Sister-in-law".

Keep the existing RelationshipType enum as-is. Note: We only store parent/child/spouse relationships. Siblings are derived at runtime from shared parents (see Task 3).
  </action>
  <verify>TypeScript compiles without errors: `npx tsc --noEmit`</verify>
  <done>FamilyMember interface has optional gender field</done>
</task>

<task type="auto">
  <name>Task 2: Replace mock data with Herman family</name>
  <files>src/utils/mockData.ts</files>
  <action>
Replace existing mock data with the Herman family structure from CONTEXT.md:

**9 family members (3 generations):**

Generation 1 (Grandparents):
1. **Peggy Deleenheer** (id: 'peggy') - Grandma (Mom's mom), female, married to Ron
2. **Ron Deleenheer** (id: 'ron') - Grandpa (Mom's dad), male, married to Peggy

Generation 2 (Parents):
3. **Shelby Herman** (id: 'shelby') - Mom, female, child of Peggy+Ron, married to Timothy
4. **Timothy Herman** (id: 'timothy') - Dad, male, married to Shelby

Generation 3 (Siblings + In-law):
5. **Ella Fu** (id: 'ella') - Older sister, female, child of Shelby+Timothy, married to Preston
6. **Preston Fu** (id: 'preston') - Brother-in-law (Ella's husband), male, married to Ella
7. **Eli Herman** (id: 'eli') - Current user, male, child of Shelby+Timothy
8. **Bennett Herman** (id: 'bennett') - Younger brother, male, child of Shelby+Timothy
9. **Ember Herman** (id: 'ember') - Younger sister, female, child of Shelby+Timothy

**Relationships to store:**
- Only parent/child and spouse relationships (NOT sibling)
- Siblings are derived at runtime from shared parents in calculateRelationship()
- Ensure bidirectional relationships (if A is B's parent, B is A's child)

**Mock data details (Claude discretion):**
- Use realistic birthdates
- Add warm, short bios for each person
- Use placeholder avatar URLs (i.pravatar.cc)

**Feed items (5-10 items):**
- Update mockFeedItems to use Herman family member IDs
- Include variety: photo, memory, milestone, prompt_response types
- Distribute authors across family members
- Use realistic dates (within last month)

**Keep mockPrompts** as-is (they're fine).
  </action>
  <verify>
- Import mockFamilyMembers and check length is 9
- Verify Peggy exists: `mockFamilyMembers.find(m => m.id === 'peggy')`
- Verify Eli has parent relationships to Shelby and Timothy
  </verify>
  <done>mockFamilyMembers contains 9 Herman family members with correct relationships, mockFeedItems updated with Herman family authors</done>
</task>

<task type="auto">
  <name>Task 3: Create relationship calculation utility</name>
  <files>src/utils/relationships.ts</files>
  <action>
Create a new file with relationship calculation utilities.

**Main function:**
```typescript
export function calculateRelationship(
  currentUserId: string,
  targetId: string,
  members: FamilyMember[]
): string
```

**Algorithm (from RESEARCH.md):**
1. If currentUserId === targetId, return 'You'
2. Check direct relationships first (parent, child, spouse)
3. **Derive siblings:** If current user and target share at least one parent, they are siblings. Return "Your Sister" or "Your Brother" based on target's gender.
4. One-hop for in-laws: if target is sibling's spouse, return "Brother-in-law" or "Sister-in-law" based on gender
5. Two-hop for grandparents: if target is parent's parent, return "Grandma" or "Grandpa" based on gender
6. Default to 'Family' for unrecognized relationships

**Format helpers:**
```typescript
function formatDirectRelationship(type: RelationshipType, target: FamilyMember): string
```
Returns: "Your Mom", "Your Dad", "Your Sister", "Your Brother", "Your Spouse", "Your Son", "Your Daughter"

**Use gender field** for gendered labels. If gender is undefined, use neutral terms.

**Do NOT over-engineer:** This is for 9 family members. Simple traversal is fine.
  </action>
  <verify>
Manual test in file (can be removed later):
```typescript
// Eli viewing Shelby should return "Your Mom"
// Eli viewing Preston should return "Your Brother-in-law"
// Eli viewing Peggy should return "Your Grandma"
```
  </verify>
  <done>calculateRelationship function exists and correctly calculates relationships from Eli's perspective</done>
</task>

</tasks>

<verification>
After completing all tasks:
1. Run `npx tsc --noEmit` - no TypeScript errors
2. Verify mockFamilyMembers.length === 9
3. Verify calculateRelationship('eli', 'shelby', mockFamilyMembers) returns "Your Mom"
4. Verify calculateRelationship('eli', 'preston', mockFamilyMembers) returns "Your Brother-in-law"
5. Verify calculateRelationship('eli', 'peggy', mockFamilyMembers) returns "Your Grandma"
</verification>

<success_criteria>
- FamilyMember type has optional gender field
- mockFamilyMembers contains exactly 9 Herman family members
- All members have correct bidirectional relationships
- mockFeedItems uses Herman family member IDs as authors
- calculateRelationship correctly labels: parent, grandparent, sibling, in-law
</success_criteria>

<output>
After completion, create `.planning/phases/01-data-foundation/01-01-SUMMARY.md`
</output>
